{% extends "base.html" %}

{% block content %}
<div class="container mt-4" 
     style="background-color: #f8f9fa; border-radius: 10px; padding: 20px; box-shadow: 0 2px 6px rgba(0,0,0,0.05);">

    <!-- Environment Label + prominent staging banner -->
    {% if env_label %}
        <div style="display:flex;align-items:center;justify-content:space-between; gap:1rem; margin-bottom: 18px;">
            <h2 style="margin:0; font-weight:700;">
                {{ env_label }}
            </h2>

            {% if 'Staging' in env_label or 'staging' in env_label|lower %}
            <!-- Changed light background for staging banner -->
            <div style="background:#fff1f1; color:#a00000; padding:8px 12px; 
                        border-radius:6px; font-weight:700; 
                        box-shadow:0 1px 2px rgba(0,0,0,0.08);">
                ⚠️ STAGING — Not for production
            </div>
            {% endif %}
        </div>
        <hr>
    {% endif %}

    <!-- Info row: timestamp + quick link -->
    <div class="d-flex justify-content-between align-items-center mb-3">
        <div class="text-muted small" id="deploy-info">
            Loaded at: <span id="ts">--</span>
        </div>
        <div>
            <!-- Changed button color from blue to green -->
            <a href="/" class="btn btn-outline-success btn-sm">View Production</a>
        </div>
    </div>

    <!-- Student Table -->
    <table class="table table-bordered table-hover">
        <!-- Changed table header background color -->
        <thead style="background-color: #e6f2ff;">
            <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Course</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
        {% for student in students %}
            <tr>
                <td>{{ student.name }}</td>
                <td>{{ student.email }}</td>
                <td>{{ student.course }}</td>
                <td>
                    <a href="{{ url_for('update_student', student_id=student._id) }}" 
                       class="btn btn-warning btn-sm">Edit</a>
                    <a href="{{ url_for('delete_student', student_id=student._id) }}" 
                       class="btn btn-danger btn-sm">Delete</a>
                </td>
            </tr>
        {% else %}
            <tr>
                <td colspan="4" class="text-center text-muted">No students found.</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    <footer class="mt-4">
        <small class="text-muted">
            App environment: <strong>{{ env_label or 'production' }}</strong>
        </small>
    </footer>
</div>

<!-- Client-side timestamp -->
<script>
  const now = new Date();
  document.getElementById('ts').textContent = now.toLocaleString();
</script>
{% endblock %}
